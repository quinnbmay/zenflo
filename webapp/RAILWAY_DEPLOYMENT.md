# Deployment Guide for Combined Memory Coder

This app has two deployment targets:
1. **Railway** - Web app deployment (testing/access via browser)
2. **Expo EAS** - iOS production app builds

---

## Railway Web App Deployment

Railway serves the web version of the app at a public URL for browser access.

### Current Configuration

- **Repository**: `quinnbmay/happy`
- **Branch**: `main`
- **Railway Project**: Combined Memory
- **Railway Service**: Web App
- **Auto-Deploy**: Enabled (deploys on push to main)

### Railway Deployment Process

#### 1. Make Changes
Edit your code as needed:
- Update React Native components in `sources/`
- Modify branding assets in `sources/assets/images/`
- Change configuration in `app.config.js` (iOS-only config)

#### 2. Export Web Build
Before deploying, export the latest web version:

```bash
# Navigate to project
cd /Users/quinnmay/developer/happy-mobile

# Export web app (updates dist folder)
npx expo export --platform web

# Verify build locally (optional)
npx serve dist
# Open http://localhost:8000 to test
```

#### 3. Commit and Push
```bash
# Stage all changes including new dist build
git add -A

# Commit with descriptive message
git commit -m "Update web app - [describe changes]"

# Push to trigger Railway deployment
git push origin main
```

#### 4. Railway Auto-Deploys
- Railway detects the push to `main`
- Builds using `Dockerfile.railway` (or default web config)
- Deploys to production URL
- Takes 1-2 minutes typically

#### 5. Verify Deployment
- Check Railway dashboard: https://railway.app
- Visit your web app URL
- Test functionality in browser
- Check for Q branding in headers
- Verify QUINN CODE logo on welcome screen

### Railway Configuration Files

Key files for Railway deployment:
- `dist/` - Built web app output (generated by expo export)
- `app.config.js` - App configuration
- `Dockerfile.railway` - Docker build config (if custom)
- `package.json` - Dependencies

### Troubleshooting Railway

#### Web App Shows Blank Screen
```bash
# Clear cache and rebuild
rm -rf dist .expo/web-cache
npx expo export --platform web
git add dist
git commit -m "Rebuild web app"
git push origin main
```

#### Old Branding Showing
```bash
# Force rebuild with cache clear
rm -rf dist .expo
npx expo export --platform web
git add -A
git commit -m "Update branding assets"
git push origin main
```

#### Railway Build Failed
- Check Railway logs in dashboard
- Verify `dist/` folder is committed
- Ensure all dependencies in package.json
- Check for syntax errors in code

---

## iOS Production Builds (Expo EAS)

Expo EAS builds the native iOS app for installation on iPhone/iPad.

### Prerequisites

1. **Install EAS CLI**
```bash
npm install -g eas-cli
```

2. **Login to Expo**
```bash
eas login
# Use your Expo account credentials
```

3. **Configure EAS Project**
Make sure `app.config.js` has:
```javascript
extra: {
    eas: {
        projectId: "c92795a3-d883-41c0-b761-3effaa823810"
    }
}
```

### iOS Build Process

#### 1. Prepare for Build
```bash
# Navigate to project
cd /Users/quinnmay/developer/happy-mobile

# Ensure all changes committed
git status

# Update version if needed (in app.config.js)
# version: "1.5.1" -> "1.5.2"
```

#### 2. Build for iOS

**Production Build (for TestFlight/App Store):**
```bash
eas build --platform ios --profile production
```

**Development Build (for testing on device):**
```bash
eas build --platform ios --profile development
```

**Local Build (build on your Mac):**
```bash
eas build --platform ios --profile production --local
```

#### 3. Build Process
- EAS uploads your code to Expo servers
- Builds native iOS app in the cloud
- Takes 10-20 minutes typically
- You'll get a download URL when complete

#### 4. Download & Install

**For Production Builds:**
- Download .ipa file from EAS build page
- Upload to TestFlight via App Store Connect
- Or install directly via Apple Configurator

**For Development Builds:**
- Download .app file
- Install via Xcode or Apple Configurator
- Requires device to be registered in Apple Developer

### EAS Configuration

EAS uses `eas.json` for build profiles:

```json
{
  "build": {
    "production": {
      "ios": {
        "bundleIdentifier": "com.combinedmemory.coder",
        "buildConfiguration": "Release"
      }
    },
    "development": {
      "ios": {
        "bundleIdentifier": "com.combinedmemory.coder.dev",
        "buildConfiguration": "Debug"
      }
    }
  }
}
```

### iOS Build Profiles

**Production Profile:**
- For App Store submission or TestFlight
- Optimized and minified
- No debugging tools
- Requires distribution certificate

**Development Profile:**
- For testing on physical devices
- Includes debugging tools
- Faster build time
- Requires development certificate

### Troubleshooting iOS Builds

#### Build Failed - Missing Certificates
```bash
# EAS will prompt to generate certificates automatically
# Or manage manually in Apple Developer Portal
eas credentials
```

#### Build Failed - Code Signing
```bash
# Clear credentials and regenerate
eas build --platform ios --clear-cache
```

#### App Crashes on Launch
```bash
# Check EAS build logs
eas build:list
# Click on build ID to see logs
```

#### Old Assets Showing in iOS App
```bash
# Clear Expo cache
npx expo start -c

# Rebuild with EAS
eas build --platform ios --profile production
```

---

## Current Branding Assets

All builds (Railway web and iOS) use:
- **Main Logo**: `QUINN CODE.png` (188 KB)
- **Header Icon**: `Q ICON BLACK.png` (1.1 MB)
- **iOS App Icon**: `Icon-iOS-Default-1024x1024@1x.png` (1.1 MB)

Located in: `sources/assets/images/`

---

## Deployment Checklist

### Before Deploying to Railway (Web)
- [ ] Export web build: `npx expo export --platform web`
- [ ] Test locally: `npx serve dist`
- [ ] Commit dist folder: `git add dist`
- [ ] Push to main: `git push origin main`
- [ ] Verify Railway deployment in dashboard
- [ ] Test web app URL in browser

### Before Building iOS with EAS
- [ ] Update version in `app.config.js` if needed
- [ ] Commit all changes: `git add -A && git commit`
- [ ] Run EAS build: `eas build --platform ios --profile production`
- [ ] Wait for build completion (10-20 min)
- [ ] Download .ipa file
- [ ] Test on device or upload to TestFlight

---

## Common Commands Reference

### Railway (Web)
```bash
# Export web build
npx expo export --platform web

# Test locally
npx serve dist

# Deploy to Railway
git push origin main
```

### iOS (EAS)
```bash
# Production build
eas build --platform ios --profile production

# Development build
eas build --platform ios --profile development

# Check build status
eas build:list

# View build details
eas build:view [BUILD_ID]
```

---

## Contact

For deployment issues:
- **Email**: quinn@combinedmemory.com
- **Repository**: https://github.com/quinnbmay/happy
- **Railway Dashboard**: https://railway.app
- **EAS Dashboard**: https://expo.dev

---

**Note**: This is a customized fork of Happy Coder. Railway deploys the web version, while EAS builds the native iOS app.

Original project: [Happy Coder](https://github.com/slopus/happy)
